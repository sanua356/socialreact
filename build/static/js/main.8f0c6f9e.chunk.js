(this.webpackJsonpsocialreact=this.webpackJsonpsocialreact||[]).push([[0],{10:function(e,a,t){e.exports={loginScreen:"loginRoom_loginScreen__3yCO_",loginroomBlock:"loginRoom_loginroomBlock__3BZat",positionForm:"loginRoom_positionForm__3eOr5",form:"loginRoom_form__360a5",titleAndLogo:"loginRoom_titleAndLogo__YrJ22",messageFromDB:"loginRoom_messageFromDB__2q82M",fieldBlock:"loginRoom_fieldBlock__3oYKI",loginBtn:"loginRoom_loginBtn__AMjOY",error:"loginRoom_error__2fhxt",createNewRoom:"loginRoom_createNewRoom__2hoKS"}},135:function(e,a,t){e.exports=t.p+"static/media/username2.b84e94b3.png"},136:function(e,a,t){e.exports=t.p+"static/media/error.8dd46f3d.png"},142:function(e,a,t){e.exports=t.p+"static/media/loginIcon2.b84e94b3.png"},143:function(e,a,t){e.exports=t(310)},148:function(e,a,t){},149:function(e,a,t){},310:function(e,a,t){"use strict";t.r(a);var s=t(0),n=t.n(s),r=t(62),o=t.n(r),c=(t(148),function(e){e&&e instanceof Function&&t.e(6).then(t.bind(null,311)).then((function(a){var t=a.getCLS,s=a.getFID,n=a.getFCP,r=a.getLCP,o=a.getTTFB;t(e),s(e),n(e),r(e),o(e)}))}),l=(t(149),t(67)),m=t(1),i=t(25),u=t(18),g=t.n(u),d=t(37),E=t(168),f={addNewMessageFromServer:function(e,a,t,s){if(e&&a&&t)return i.post("http://socialreactapi/addnewmessage.php?roomid=".concat(e),{userSenderMessage:a,message:t,usernameSecretKey:s})},getMessagesFromServer:function(){var e=Object(d.a)(g.a.mark((function e(a,t,s,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=6;break}return e.next=3,i.get("http://socialreactapi/roomsgetmessages.php?roomid=".concat(a,"&username=").concat(s,"&usernamesecretkey=").concat(n));case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,i.get("http://socialreactapi/roomsgetmessages.php?roomid=".concat(a,"&firstmessageid=").concat(t,"&username=").concat(s,"&usernamesecretkey=").concat(n));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(a,t,s,n){return e.apply(this,arguments)}}(),deleteMessages:function(){var e=Object(d.a)(g.a.mark((function e(a,t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a,t),e.next=3,i.delete("http://socialreactapi/deletemessages.php?roomid=".concat(a),{data:{messagesID:t}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}()},S={checkRoomExists:function(){var e=Object(d.a)(g.a.mark((function e(){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("roomID"),e.next=3,i.get("http://socialreactapi/roomsexists.php?roomid=".concat(a));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createNewRoom:function(){var e=Object(d.a)(g.a.mark((function e(){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("roomID"),e.next=3,i.get("http://socialreactapi/createnewroom.php?roomid=".concat(a));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),webSocketConnect:function(e,a,t){var s={roomID:e,username:a,usernameSecretKey:E.MD5(t)};return i.post("/rooms",s)}},_="SAVE_ROOMID_AND_USERNAME_LOCALSTORAGE",h="CHANGE_ROOM_EXISTS_STATUS",p={username:"",roomID:"",usernameSecretKey:"",isLoggined:!1,roomIsExists:!1};function b(e){return{type:"CHANGE_ROOM_EXISTS_STATUS",existsStatus:e}}var v="SEND_LOGINROOM_DATA",M="CHANGE_NAME_STATUS_LOGGINING_BTN",I="CHANGE_ROOM_IS_EXISIS_SERVER_RESPONSE",N="CHANGE_CREATE_OR_LOGIN_STATUS",O="SET_ERROR_MESSAGE";function y(e,a,t){return{type:"SEND_LOGINROOM_DATA",usernameFieldValue:e,usernameSecretKeyFieldValue:a,roomIDFieldValue:t}}function R(e,a){return{type:"CHANGE_NAME_STATUS_LOGGINING_BTN",changedName:e,enableStatus:a}}function D(e){return{type:"CHANGE_ROOM_IS_EXISIS_SERVER_RESPONSE",messageServerData:e}}function C(e){return{type:"SET_ERROR_MESSAGE",errorMessage:e}}var L={changedUsername:"",changedRoomID:"",changedSecretKeyUsername:"",notCorrectValidationData:"",loginBtnName:"Login",loginBtnClickableStatus:!0,roomIsExistsServerResponse:"",errors:""},A=function(){return function(e){e(R("Loggining..."),!1),S.checkRoomExists().then((function(a){console.log(a.data),null!=a.data?(console.log("Room yes"),e(D(a.data)),e(b(!0)),e(R("Login",!0))):(console.log("Room does not exists."),e(D(a.data)),e(b(!1)),e(R("Login"),!0))})).catch((function(a){e(b(!1)),e(R("Login",!0)),e(C("Not connection. Try again later."))}))}},x=t(9),T=t(132),k=t.n(T)()(),B="ADD_NEW_MESSAGE_FROM_DATA_BASE",j="GET_MESSAGES_LIST_FROM_API",F="CHANGE_LOADING_STATUS",w="ADD_ERROR_MESSAGE",P="SELECT_MESSAGE_FROM_CHAT",G="DELETE_MESSAGES_FROM_CHAT",U="ADD_ERROR_SERVER_MESSAGE_NOTIFICATION";function K(e,a,t,s,n,r){return{type:"ADD_NEW_MESSAGE_FROM_DATA_BASE",errors:e,username:a,roomID:t,message:s,messageID:n,messageOwner:r}}function V(e,a,t,s,n){return{type:"GET_MESSAGES_LIST_FROM_API",roomID:e,messagesJSON:a,errors:t,firstMessageID:s,loadedMessagesArrayLength:n}}function H(e){return{type:"CHANGE_LOADING_STATUS",loadingStatus:e}}function W(e){return{type:"ADD_ERROR_MESSAGE",error:e}}function J(e){return{type:"ADD_ERROR_SERVER_MESSAGE_NOTIFICATION",errorServerMessagesNotification:e}}var z={messagesList:[],messagesEmptyStatusRoom:!1,errors:"",isLoading:!1,seletctedMessages:[],errorServerMessagesNotification:"",firstMessageID:null,loadedMessagesArrayLength:0,lastMessageID:-1},q=function(e,a,t){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4?arguments[4]:void 0;return function(r){try{if(a)return r(H(!0)),f.getMessagesFromServer(e,s,t,n).then((function(a){r(V(e,a.data,"",s,a.data.length)),r(H(!1))})).catch((function(e){r(W("Sorry. We have not received any data from the server. Please try again later."))}));r(W("No saved messages from room as room not exist"))}catch(o){console.log("\u041e\u043f\u0430\u0430\u0430\u0430... \u041f\u0438\u0437\u0434\u0435\u0446.")}}},Y=t(6),X=t(51),Q={sidebarMenuItems:[{itemName:"Profile",link:"/profile",icon:X.c},{itemName:"Messages",link:"/messages",icon:X.b},{itemName:"Updates",link:"/updates",icon:Y.c},{itemName:"Exit",link:"/logout",icon:Y.b}]},Z=t(133),$=t(25),ee="CHANGE_CONNECTING_STATUS",ae="CHANGE_USERS_LIST",te=function(e){return{type:"CHANGE_CONNECTING_STATUS",status:e}},se=function(e){return{type:"CHANGE_USERS_LIST",users:e}},ne={connectingStatus:!1,users:[]},re=Object(l.b)({manyPages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,a=arguments.length>1?arguments[1]:void 0,t=Object(m.a)({},e);switch(a.type){case _:return t=Object(m.a)({},e),null!==localStorage.getItem("username")&&null!==localStorage.getItem("roomID")&&null!==localStorage.getItem("usernameSecretKey")?(t.username=localStorage.getItem("username"),t.roomID=localStorage.getItem("roomID"),t.usernameSecretKey=localStorage.getItem("usernameSecretKey"),t.isLoggined=!0):t.isLoggined=!1,t;case h:return(t=Object(m.a)({},e)).roomIsExists=a.existsStatus,t;default:return e}},messagesPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,a=arguments.length>1?arguments[1]:void 0,t=Object(m.a)({},e);switch(a.type){case B:if(t=Object(m.a)(Object(m.a)({},e),{},{messagesList:Object(x.a)(e.messagesList)}),a.message&&t.lastMessageID!=a.messageID){var s="opponent";"me"===a.messageOwner&&(s="me");var n={id:a.messageID,dateTimeMessage:Date.now(),messageSender:a.username,message:a.message,errors:a.errors,messageOwnership:s};return t.messagesList.push(n),t.lastMessageID=a.messageID,console.log("Message sended"),t.messagesEmptyStatusRoom=!1,console.log(t.messagesList),t}return t.errors="Message is empty",console.log("Message is empty!"),t;case j:if(t=Object(m.a)(Object(m.a)({},e),e.messagesList),a.firstMessageID||(t.messagesList=[]),t.errors="",t.messagesEmptyStatusRoom=!1,t.loadedMessagesArrayLength=a.loadedMessagesArrayLength,null!==a.messagesJSON)if("No messages"!==a.messagesJSON){var r=a.messagesJSON.reverse();if(console.log(r),t.firstMessageID=r[0].id,a.firstMessageID){for(var o=[],c=0;c<r.length;c++)o.push(r[c]);t.messagesList=[].concat(o,Object(x.a)(t.messagesList))}else for(var l=0;l<r.length;l++)t.messagesList.push(r[l])}else t.messagesEmptyStatusRoom=!0;else t.errors=!0;return t;case F:return(t=Object(m.a)({},e)).isLoading=a.loadingStatus,t;case w:return(t=Object(m.a)({},e)).errors=a.error,t;case P:var i=(t=Object(m.a)({},e)).seletctedMessages.indexOf(a.messageID);return-1==i?t.seletctedMessages.push(a.messageID):t.seletctedMessages.splice(i,1),t;case G:return t=Object(m.a)(Object(m.a)({},e),{},{messagesList:Object(x.a)(e.messagesList),seletctedMessages:Object(x.a)(e.seletctedMessages)});case U:return(t=Object(m.a)({},e)).errorServerMessagesNotification=a.errorServerMessagesNotification,console.log(t),t;default:return e}},sidebarPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q;return e},loginRoomPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,a=arguments.length>1?arguments[1]:void 0,t=Object(m.a)({},e);switch(a.type){case v:return localStorage.clear(),localStorage.setItem("username",a.usernameFieldValue),localStorage.setItem("roomID",a.roomIDFieldValue),localStorage.setItem("usernameSecretKey",a.usernameSecretKeyFieldValue),t.notCorrectValidationData="",t.usernameFieldValue="",t.roomIDFieldValue="",t;case M:return(t=Object(m.a)({},e)).loginBtnClickableStatus=a.enableStatus,t.loginBtnName=a.changedName,t;case I:return t=Object(m.a)({},e),null==a.messageServerData?t.roomIsExistsServerResponse=null:t.roomIsExistsServerResponse=a.messageServerData,t;case N:return(t=Object(m.a)({},e)).createOrLoginStatus=a.status,t;case O:return(t=Object(m.a)({},e)).errors=a.errorMessage,t;default:return e}},webSocket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case ee:return Object(m.a)(Object(m.a)({},e),{},{connectingStatus:a.status});case ae:return Object(m.a)(Object(m.a)({},e),{},{users:a.users});default:return e}}}),oe=Object(l.c)(re,Object(l.a)(Z.a)),ce=t(17),le=t(49),me=t(4),ie=t(33),ue=t.n(ie),ge=t(7),de=t(135),Ee=t.n(de);var fe=Object(ce.b)((function(e){return{username:e.manyPages.username,sidebarMenuItems:e.sidebarPage.sidebarMenuItems}}),null)((function(e){var a=e.sidebarMenuItems.map((function(a){return n.a.createElement(le.b,{to:a.link,key:e.sidebarMenuItems.indexOf(a),activeClassName:ue.a.activeLink},n.a.createElement("li",{className:ue.a.menuItemStyle},n.a.createElement("span",{className:ue.a.menuItemIcon},n.a.createElement(ge.a,{icon:a.icon})),n.a.createElement("span",{className:ue.a.menuItemName},a.itemName)))}));return n.a.createElement("div",{className:ue.a.navbar},n.a.createElement("h2",{className:ue.a.navbarSiteTitle},"ANONUMOUS CHAT"),n.a.createElement("div",{className:ue.a.userBlock},n.a.createElement("img",{src:Ee.a,alt:"username"}),n.a.createElement("span",null,"Your name: ",e.username)),n.a.createElement("nav",null,n.a.createElement("ul",null,a)))})),Se=t(53),_e=t.n(Se),he=t(136),pe=t.n(he);var be=function(e){return n.a.createElement("div",{className:"workspace"},n.a.createElement("div",{className:"".concat(_e.a.dFlexScreenLoader," ").concat(_e.a.loader)},e.lazyLoadComponent&&!e.errors?n.a.createElement("aside",null,n.a.createElement("div",{className:_e.a.ldsRoller},n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null))):n.a.createElement("div",{className:_e.a.dFlexScreenLoader},n.a.createElement("img",{src:pe.a,alt:"error image"}),n.a.createElement("h1",null,"Error"),n.a.createElement("span",null,e.errors))))},ve=t(82),Me=t.n(ve),Ie=t(14),Ne=t(39),Oe=t.n(Ne),ye=t(42),Re=t(32),De=t(38),Ce=t.n(De),Le=(t(309),{title:"Notification",message:"Notification message",type:"danger",insert:"top",container:"top-center",dismiss:{duration:2e3,pauseOnHover:!0,onScreen:!0}}),Ae=function(e){var a=Object(s.useState)(e.selectedMessagesLength),t=Object(Ie.a)(a,2),r=t[0],o=t[1];Object(s.useEffect)((function(){o(e.selectedMessagesLength)}),[e.selectedMessagesLength]),Object(s.useEffect)((function(){e.errorServerMessagesNotification&&(De.store.addNotification(Object(m.a)(Object(m.a)({},Le),{},{title:"Error",message:e.errorServerMessagesNotification})),e.clearServerMessageAfterView())}),[e.errorServerMessagesNotification]),Object(s.useEffect)((function(){k.on("ROOM:SET_USERS",(function(a){e.setUsersList(a)})),k.on("ROOM:NEW_MESSAGE",(function(a){var t=a.username,s=a.text,n=a.messageID;e.sendNewMessageWS(e.errors,t,e.roomID,s,n,"opponent")}))}),[]);var c=Re.a().shape({messageTextarea:Re.b().typeError("This field should be string").required("Message field is empty")});return n.a.createElement(n.a.Fragment,null,n.a.createElement(ye.c,{initialValues:{messageTextarea:""},onSubmit:function(a,t){e.sendNewMessageDB(e.errors,e.myUsername,e.roomID,a.messageTextarea,e.usernameSecretKey,e.messagesListLength,e.errorServerMessagesNotification),t.setFieldValue("messageTextarea","")},validationSchema:c,validateOnBlur:!0},(function(a){var t=a.values,s=a.handleChange,o=a.isValid,c=a.handleSubmit,l=a.dirty;return n.a.createElement("div",{className:Oe.a.controlElementsChat},n.a.createElement("div",{className:Oe.a.controlElementsChatHeaderWithTextareaBtns},n.a.createElement("div",{disabled:!r>=1,className:Oe.a.changeSendedMessageControlsBtns,onClick:!r>=1?function(){return De.store.addNotification(Object(m.a)(Object(m.a)({},Le),{},{title:"Error",message:"There are no messages selected for deletion."}))}:null},n.a.createElement("span",{onClick:function(){return e.deleteMessages(e.roomID,e.selectedMessages)}},n.a.createElement(ge.a,{icon:Y.h}),"Delete")),n.a.createElement("div",{disabled:1!==r,className:Oe.a.changeSendedMessageControlsBtns,onClick:1!==r?function(){return De.store.addNotification(Object(m.a)(Object(m.a)({},Le),{},{title:"Error",message:"No message selected for change."}))}:function(){return De.store.addNotification(Object(m.a)(Object(m.a)({},Le),{},{title:"Error",message:"This functional is development."}))}},n.a.createElement("span",null,n.a.createElement(ge.a,{icon:Y.c}),"Change"))),n.a.createElement(ye.b,{className:Oe.a.controlsBtns},n.a.createElement(ye.a,{as:"textarea",type:"textarea",name:"messageTextarea",placeholder:"Enter new message...",value:t.messageTextarea,onChange:s,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),c())}})," ",n.a.createElement("button",{disabled:!o&&!l||!l,type:"submit",id:Oe.a.sendMessageBtn,onSubmit:c}," ",n.a.createElement(ge.a,{icon:Y.e}))))})),n.a.createElement(Ce.a,null))},xe=t(8),Te=t.n(xe);function ke(e){return"me"===e?Te.a.myMessage:Te.a.opponentMessage}var Be=n.a.memo((function(e){var a=n.a.createRef(),t=Object(s.useState)(!1),r=Object(Ie.a)(t,2),o=r[0],c=r[1],l=function(e,a,t,s,r,o){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(Object.keys(e).length>0){var l=e.map((function(a){return n.a.createElement("div",{className:"".concat(Te.a.message," \n          ").concat(ke(a.messageOwnership),"\n          ").concat(a.errors&&Te.a.errorMessage,"\n          ").concat(-1!==r.indexOf(a.id)&&Te.a.selectedMessage),key:e.indexOf(a)},"me"===a.messageOwnership&&n.a.createElement("div",{className:Te.a.messageInfo},n.a.createElement(ge.a,{icon:Y.k,className:"fas fa-lg"}),n.a.createElement("span",{className:Te.a.messageSender},a.messageSender)),n.a.createElement("p",{onClick:function(){"me"===a.messageOwnership&&(s(a.id),o(!c))}},a.message," ",a.errors&&n.a.createElement("span",{className:Te.a.errorMessageIcon,title:"Message not sended"},n.a.createElement(ge.a,{icon:Y.f,className:"fas fa-md"}))),"opponent"===a.messageOwnership&&n.a.createElement("div",{className:Te.a.messageInfo},n.a.createElement(ge.a,{icon:Y.j,className:"fas fa-lg"}),n.a.createElement("span",{className:Te.a.messageSender},a.messageSender)))}));return l}return n.a.createElement("div",{className:Te.a.messagesList},n.a.createElement("p",{className:Te.a.messagesList},a)," //\u0415\u0441\u043b\u0438 \u0435\u0441\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0438, \u043e\u043d\u0438 \u0432\u044b\u0432\u0435\u0434\u0443\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u044d\u0442\u043e\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442")}(e.messagesList,e.errors,e.myUsername,e.selectMessageFromChat,e.selectedMessages,c,o);return Object(s.useEffect)((function(){e.messagesList.length&&(a.current.scrollTop=a.current.scrollHeight)}),[e.messagesList]),n.a.createElement(n.a.Fragment,null,e.messagesEmptyStatus?n.a.createElement("div",{className:Te.a.notification},n.a.createElement("span",{className:Te.a.errors},"No saved messages from room.")):n.a.createElement("div",{className:Te.a.messagesList,ref:a},e.loadedMessagesArrayLength>=10?n.a.createElement("button",{type:"button",className:Te.a.loadMoreBtn,onClick:function(){return e.loadMoreMessages(e.roomID,e.roomIsExists,e.myUsername,e.firstMessageID,e.usernameSecretKey)}},"Load more messages"):null,l))})),je=t(84);var Fe=function(e){return n.a.createElement("div",{className:"workspace"},n.a.createElement("main",{className:Me.a.Main},n.a.createElement("div",{className:Me.a.chatBlock},n.a.createElement(je.a,Object.assign({},e,{loadedFromMessagesPage:!0,headerTitle:"Room: ".concat(e.roomID),headerDescription:"Users: ".concat(e.usersCount," ")})),n.a.createElement(Be,e),n.a.createElement(Ae,e))))};var we=Object(ce.b)((function(e){return{myUsername:e.manyPages.username,roomID:e.manyPages.roomID,messagesList:e.messagesPage.messagesList,changedTextareaMessage:e.messagesPage.changedTextareaMessage,errors:e.messagesPage.errors,isLoading:e.messagesPage.isLoading,roomIsExists:e.manyPages.roomIsExists,messagesEmptyStatus:e.messagesPage.messagesEmptyStatusRoom,selectedMessages:e.messagesPage.seletctedMessages,selectedMessagesLength:e.messagesPage.seletctedMessages.length,usernameSecretKey:e.manyPages.usernameSecretKey,messagesListLength:e.messagesPage.messagesList.length,errorServerMessagesNotification:e.messagesPage.errorServerMessagesNotification,firstMessageID:e.messagesPage.firstMessageID,loadedMessagesArrayLength:e.messagesPage.loadedMessagesArrayLength,usersCount:e.webSocket.users.length}}),(function(e){return{sendNewMessageDB:function(a,t,s,n,r){e(function(e,a,t,s,n,r){return function(o){var c;f.addNewMessageFromServer(t,a,s,n,r).then((function(l){"null"!==l.data?(c=l.data,k.emit("ROOM:NEW_MESSAGE",{roomID:t,username:a,usernameSecretKey:n,text:s,messageID:c})):c=r+1,o(K(e,a,t,s,c,"me"))})).catch((function(){o(K("Oopps. Message not sended. Try again later.",a,t,s,r+1,"me")),o(J("Oopps. Message not sended. Try again later."))}))}}(a,t,s,n,r))},sendNewMessageWS:function(a,t,s,n,r){e(K(a,t,s,n,r))},changeLoadingStatus:function(a){e(H(a))},selectMessageFromChat:function(a){e(function(e){return{type:"SELECT_MESSAGE_FROM_CHAT",messageID:e}}(a))},deleteMessages:function(a,t){e(function(e,a){return function(){var t=Object(d.a)(g.a.mark((function t(s){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.length>=1)){t.next=8;break}return t.next=3,f.deleteMessages(e,a);case 3:return n=t.sent,console.log(n),t.abrupt("return",n);case 8:console.log("Messages list is empty!");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(a,t)),e({type:"DELETE_MESSAGES_FROM_CHAT"})},clearServerMessageAfterView:function(){e(J(""))},loadMoreMessages:function(a,t,s,n,r){e(q(a,t,s,n,r))},setUsersList:function(a){e(se(a))}}}))(Fe),Pe=function(e){return Object(s.useEffect)((function(){e.messagesList<=0&&(e.getMessagesFromServerTC(e.roomID,e.roomIsExists,null,e.myUsername,e.usernameSecretKey),e.webSocketConnect(e.roomID,e.myUsername,e.usernameSecretKey))}),[]),n.a.createElement(n.a.Fragment,null,e.isLoading?n.a.createElement(be,{errors:e.errors,lazyLoadComponent:!0}):n.a.createElement(we,null))},Ge=Object(ce.b)((function(e){return{myUsername:e.manyPages.username,usernameSecretKey:e.manyPages.usernameSecretKey,roomID:e.manyPages.roomID,isLoading:e.messagesPage.isLoading,roomIsExists:e.manyPages.roomIsExists,errors:e.messagesPage.errors,messagesList:e.messagesPage.messagesList,webSocketConnected:e.webSocket.connectingStatus}}),(function(e){return{getMessagesFromServerTC:function(a,t,s,n,r){e(q(a,t,n,s,r))},webSocketConnect:function(a,t,s){e(function(e,a,t){return function(s){S.webSocketConnect(e,a,t).then((function(n){if("ok"===n.data){console.log("WS Connected :)"),s(te(!0));var r={roomID:e,username:a,usernameSecretKey:t};k.emit("ROOM:JOIN",r),$.get("/rooms/".concat(e)).then((function(e){s(se(e.data.users))})).catch((function(e){console.log("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439")}))}})).catch((function(e){throw console.log("Error WS connecting :("),s(te(!1)),e}))}}(a,t,s))}}}))(Pe);var Ue=function(){return n.a.createElement("div",null,n.a.createElement("h1",null,"404"))},Ke=n.a.lazy((function(){return t.e(4).then(t.bind(null,312))})),Ve=n.a.lazy((function(){return t.e(5).then(t.bind(null,313))})),He=n.a.lazy((function(){return t.e(3).then(t.bind(null,314))}));var We=function(e){return n.a.createElement("div",{className:"mainScreen"},n.a.createElement("div",{className:"container"},n.a.createElement(fe,{sidebarMenuItems:e.store.sidebarPage.sidebarMenuItems,myUsername:e.store.manyPages.username}),n.a.createElement(me.b,{exact:!0,path:"/profile"},n.a.createElement(s.Suspense,{fallback:n.a.createElement(be,{lazyLoadComponent:!0})},n.a.createElement(Ke,{username:e.store.manyPages.username}))),n.a.createElement(me.b,{exact:!0,path:"/updates"},n.a.createElement(s.Suspense,{fallback:n.a.createElement(be,{lazyLoadComponent:!0})},n.a.createElement(Ve,null))),n.a.createElement(me.b,{path:"/messages/:roomid?"},n.a.createElement(Ge,null)),n.a.createElement(me.b,{exact:!0,path:"/logout"},n.a.createElement(s.Suspense,{fallback:n.a.createElement(be,{lazyLoadComponent:!0})},n.a.createElement(He,null))),n.a.createElement(me.b,{exact:!0,path:"/404"},n.a.createElement(Ue,null)),n.a.createElement(me.a,{from:"*",to:"/404"}),n.a.createElement(me.a,{exact:!0,from:"/",to:"/messages"})))},Je=t(63),ze=t(10),qe=t.n(ze),Ye=t(142),Xe=t.n(Ye),Qe=function(e){var a=n.a.useState(!1),t=Object(Ie.a)(a,2),r=t[0],o=t[1],c=n.a.useState(!1),l=Object(Ie.a)(c,2),m=l[0],i=l[1],u=n.a.useState(!1),g=Object(Ie.a)(u,2),d=g[0],E=g[1];n.a.useEffect((function(){e.errors||null===e.roomExistsServerResponse&&r?i(!0):null!==e.roomExistsServerResponse&&r&&i(!1)}),[e.roomExistsServerResponse,r,e.errors]),Object(s.useEffect)((function(){e.changeCreateOrLoginStatus(d)}),[d]);var f=Re.a().shape({username:Re.b().typeError("This field should be string").min(3,"Minimum length for this field - 3 characters").max(20,"Maximum length for this field - 20 characters").required("This is a required field"),secretKeyUsername:Re.b().typeError("This field should be string").min(3,"Minimum length for this field - 3 characters").max(20,"Maximum length for this field - 20 characters").required("This is a required field"),roomID:Re.b().typeError("This field should be string").min(3,"Minimum length for this field - 3 characters").max(20,"Maximum length for this field - 20 characters").required("This is a required field")});return n.a.createElement(n.a.Fragment,null,n.a.createElement(ye.c,{initialValues:{username:"",secretKeyUsername:"",roomID:""},validateOnBlur:!0,validationSchema:f,onSubmit:function(a,t){e.sendDataFields(a.username,a.secretKeyUsername,a.roomID,d),o(!0)}},(function(a){var t=a.values,s=a.errors,r=a.touched,o=a.handleChange,c=a.handleBlur,l=a.isValid,i=a.handleSubmit,u=a.dirty;return n.a.createElement("form",{className:qe.a.form,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),i())}},n.a.createElement("div",{className:qe.a.titleAndLogo},n.a.createElement("img",{src:Xe.a,alt:"Login icon"}),n.a.createElement("h2",null,d?"Create room":"Login room")),m&&!d?n.a.createElement("span",{className:qe.a.messageFromDB},e.errors?e.errors:"Uncorrect data. Please, try again."):null," ",n.a.createElement("div",{className:qe.a.fieldBlock,tabIndex:"1"},n.a.createElement(ge.a,{icon:Y.i,className:"fas fa-lg"}),n.a.createElement("input",{name:"username",value:t.username,placeholder:"Username",type:"text",onChange:o,onBlur:c,onKeyPress:e.enterKeyPressed}),r.username&&s.username&&n.a.createElement("span",{className:qe.a.error},s.username)),n.a.createElement("div",{className:qe.a.fieldBlock,tabIndex:"2"},n.a.createElement(ge.a,{icon:Y.g,className:"fas fa-lg"}),n.a.createElement("input",{name:"secretKeyUsername",value:t.secretKeyUsername,placeholder:"Secret Key",type:"text",id:"secretKeyUsernameInput",onChange:o,onBlur:c,onKeyPress:e.enterKeyPressed}),r.secretKeyUsername&&s.secretKeyUsername&&n.a.createElement("span",{className:qe.a.error},s.secretKeyUsername)),n.a.createElement("div",{className:qe.a.fieldBlock,tabIndex:"3"},n.a.createElement(ge.a,{icon:Y.a,className:"fas fa-lg"}),n.a.createElement("input",{name:"roomID",value:t.roomID,placeholder:"Room ID",type:"text",id:"roomIdInput",onChange:o,onBlur:c,onKeyPress:e.enterKeyPressed}),r.roomID&&s.roomID&&n.a.createElement("span",{className:qe.a.error},s.roomID)),n.a.createElement("button",{disabled:!l&&!u||!u,type:"submit",onClick:i,className:qe.a.loginBtn,tabIndex:"4"},d?"Create":e.loginBtnName),n.a.createElement("span",{className:qe.a.createNewRoom,onClick:function(){E(!d)}},d?"Login exists room":"Create new room"))})))};var Ze=function(e){return n.a.createElement("div",{className:qe.a.loginScreen},n.a.createElement("div",Object(Je.a)({className:"workspace"},"className",qe.a.loginroomBlock),n.a.createElement("div",{className:qe.a.positionForm},n.a.createElement(Qe,e))))},$e=Object(ce.b)((function(e){return{usernameFieldValue:e.loginRoomPage.usernameFieldValue,roomIDFieldValue:e.loginRoomPage.roomIDFieldValue,roomID:e.manyPages.roomID,errorsValidation:e.loginRoomPage.notCorrectValidationData,loginBtnName:e.loginRoomPage.loginBtnName,loginBtnClickableStatus:e.loginRoomPage.loginBtnClickableStatus,roomIsExists:e.manyPages.roomIsExists,roomExistsServerResponse:e.loginRoomPage.roomIsExistsServerResponse,errors:e.loginRoomPage.errors}}),(function(e){return{sendDataFields:function(a,t,s,n){var r;e(C("")),e(y(a,t,s)),e({type:"SAVE_ROOMID_AND_USERNAME_LOCALSTORAGE"}),e(n?(r=n,function(e){r&&(e(R("Creating..."),!1),S.createNewRoom().then((function(a){console.log(a.data),1==a.data?(console.log("Room created"),e(b(!0)),e(R("Create",!0))):(console.log("Room not created.",a.data),e(b(!1)),e(R("Create"),!0))})).catch((function(e){console.log(e)})))}):A())},enterKeyPressed:function(a,t,s,n,r){"Enter"===a.key&&(console.log(a),e(y(t,s,n)),e({type:"SAVE_ROOMID_AND_USERNAME_LOCALSTORAGE"}),e(A()))},changeCreateOrLoginStatus:function(a){e(function(e){return{type:"CHANGE_CREATE_OR_LOGIN_STATUS",status:e}}(a))}}}))(Ze);var ea=Object(ce.b)((function(e){return{roomIsExists:e.manyPages.roomIsExists}}),(function(e){return{attemptToLoginWithOldData:function(){e({type:"SAVE_ROOMID_AND_USERNAME_LOCALSTORAGE"})},checkRoomExistsTC:function(){e(A())}}}))((function(e){return n.a.useEffect((function(){e.attemptToLoginWithOldData(),e.checkRoomExistsTC()}),[]),n.a.createElement(n.a.Fragment,null,e.roomIsExists?n.a.createElement(We,{store:e.store}):n.a.createElement($e,null))}));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(le.a,null,n.a.createElement(ce.a,{store:oe},n.a.createElement(me.a,{exact:!0,from:"/",to:"/login"}),n.a.createElement(ea,{store:oe.getState(),dispatch:oe.dispatch})))),document.getElementById("root")),window.store=oe,c()},33:function(e,a,t){e.exports={navbar:"navbar_navbar__1XM5B",navbarSiteTitle:"navbar_navbarSiteTitle__3yU6J",menuItemName:"navbar_menuItemName__2Q8ko",menuItemStyle:"navbar_menuItemStyle__2tdIa",activeLink:"navbar_activeLink__3Y2nl",menuItemIcon:"navbar_menuItemIcon__21vHZ",userBlock:"navbar_userBlock__27Q1W"}},39:function(e,a,t){e.exports={controlElementsChat:"messagesFrom_controlElementsChat__3kD7_",controlsBtns:"messagesFrom_controlsBtns__2KN13",sendMessageBtn:"messagesFrom_sendMessageBtn__39Igb",controlElementsChatHeaderWithTextareaBtns:"messagesFrom_controlElementsChatHeaderWithTextareaBtns__1lYu5",errors:"messagesFrom_errors__2R0r9",changeSendedMessageControlsBtns:"messagesFrom_changeSendedMessageControlsBtns__2V-Cl"}},43:function(e,a,t){e.exports={header:"header_header__240pj",headerRoomInfo:"header_headerRoomInfo__27DaO",headerControlsBtns:"header_headerControlsBtns__2SZ__",bellAnimation:"header_bellAnimation__3gJCI",ring:"header_ring__3RFYs",selectedMessagesCounter:"header_selectedMessagesCounter__1E3Ak"}},53:function(e,a,t){e.exports={dFlexScreenLoader:"LoaderStyles_dFlexScreenLoader__3EWrv",loader:"LoaderStyles_loader__152ED",ldsRoller:"LoaderStyles_ldsRoller__LwjCn"}},8:function(e,a,t){e.exports={messagesList:"messagesChatBubbles_messagesList__Qvbty",message:"messagesChatBubbles_message__SKylW",notification:"messagesChatBubbles_notification__2blMM",myMessage:"messagesChatBubbles_myMessage__3rWfx",opponentMessage:"messagesChatBubbles_opponentMessage__1lrG6",messageSender:"messagesChatBubbles_messageSender__2v6bY",selectedMessage:"messagesChatBubbles_selectedMessage__ekzyd",messageInfo:"messagesChatBubbles_messageInfo__2aMQc",errorMessageIcon:"messagesChatBubbles_errorMessageIcon__1RmLc",loadMoreBtn:"messagesChatBubbles_loadMoreBtn__22cbV"}},82:function(e,a,t){e.exports={Main:"messagesChatArea_Main__1mJ6C",chatBlock:"messagesChatArea_chatBlock__3Z49R"}},84:function(e,a,t){"use strict";var s=t(0),n=t.n(s),r=t(7),o=t(6),c=t(51),l=t(43),m=t.n(l),i=n.a.memo((function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.a.createElement("div",{className:m.a.header},n.a.createElement("div",{className:m.a.headerRoomInfo},n.a.createElement("h3",null,e.headerTitle),n.a.createElement("span",null,e.headerDescription)),e.selectedMessagesLength>=1&&a&&n.a.createElement("span",{className:m.a.selectedMessagesCounter},"Messages selected:",n.a.createElement("aside",null,e.selectedMessagesLength)),n.a.createElement("div",{className:m.a.headerControlsBtns},n.a.createElement("a",{href:"#"},n.a.createElement(r.a,{icon:o.d,className:"fas fa-lg"})),n.a.createElement("a",{href:"#"},n.a.createElement(r.a,{icon:c.a,className:'"fas fa-lg" '.concat(m.a.bellAnimation)}))))}));a.a=i}},[[143,1,2]]]);
//# sourceMappingURL=main.8f0c6f9e.chunk.js.map